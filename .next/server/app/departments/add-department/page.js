(()=>{var e={};e.id=703,e.ids=[703],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},3764:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),r(6898),r(3537),r(7988),r(2029),r(1930),r(5866);var s=r(3191),a=r(8716),i=r(7922),n=r.n(i),o=r(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["departments",{children:["add-department",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6898)),"E:\\Projects Repository\\task_manager\\src\\app\\departments\\add-department\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(r.bind(r,3537)),"E:\\Projects Repository\\task_manager\\src\\app\\departments\\add-department\\loading.tsx"]}]},{loading:[()=>Promise.resolve().then(r.bind(r,7988)),"E:\\Projects Repository\\task_manager\\src\\app\\departments\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2029)),"E:\\Projects Repository\\task_manager\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,1930)),"E:\\Projects Repository\\task_manager\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\Projects Repository\\task_manager\\src\\app\\departments\\add-department\\page.tsx"],u="/departments/add-department/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/departments/add-department/page",pathname:"/departments/add-department",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4022:(e,t,r)=>{Promise.resolve().then(r.bind(r,8348))},8348:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(326),a=r(9331),i=r(1191),n=r(4660),o=r(5715),l=r(5342),d=r(7567),c=r(1774),u=r(6226),p=r(7577),m=r(4723);let h="ec2-35-173-139-149.compute-1.amazonaws.com",x=()=>{let[e,t]=(0,p.useState)(null),{register:r,getValues:x,control:g,formState:{errors:y},setValue:b,reset:f,handleSubmit:v}=(0,m.cI)({resolver:(0,c.X)(d.a),defaultValues:{}});(0,p.useEffect)(()=>{let e=sessionStorage.getItem("departmentData");if(e){let r=JSON.parse(e);t(r),f(r)}},[f]);let{fields:j,append:N,remove:w}=(0,m.Dq)({control:g,name:"numericOwners"}),{fields:q,append:k,remove:_}=(0,m.Dq)({control:g,name:"requiredReports"}),{fields:P,append:R,remove:C}=(0,m.Dq)({control:g,name:"developmentPrograms"}),[Z,E]=(0,p.useState)([]),O=e=>{E(t=>t.filter((t,r)=>r!==e))};(0,p.useEffect)(()=>{e?f(e):f()},[e,f]);let[S,D]=(0,p.useState)({open:!1,message:"",severity:"success"}),M=e?`/department/updateDepartment/${e.id}`:"/department/create-department",{data:$}=(0,l.Z)({queryKey:["departments"],url:`http://${h}/department/get-departments`,setSnackbarConfig:D}),{data:F}=(0,l.Z)({queryKey:["categories"],url:`http://${h}/job-categories`,setSnackbarConfig:D}),{mutate:A,isPending:I,isSuccess:K,isError:T,error:G}=(0,o.s)({endpoint:M,onSuccessMessage:"Departments added successfully!",invalidateQueryKeys:["departments"]}),U=async()=>{let e=x();e.supportingFiles=Z.map(e=>e.name),console.log("Form data with files:",e),A(e)};(0,p.useEffect)(()=>{K?(sessionStorage.clear(),D({open:!0,message:e?"Department updated successfully!":"Department created successfully!",severity:"success"}),f({id:"",parentDepartmentId:"",description:"",name:"",goal:"",category:"",mainTasks:"",numericOwners:[],supportingFiles:[],requiredReports:[],developmentPrograms:[]}),E([])):T&&console.error("Failed to create/update the department",G)},[e,G,T,K,f]);let[X,z]=(0,p.useState)(!1),[L,V]=(0,p.useState)(""),[B,J]=(0,p.useState)(["primary-department","secondary-department","sub-department"]),[Q,Y]=(0,p.useState)([]);(0,p.useEffect)(()=>{F&&Y(F.map(e=>e.name))},[F]);let H=()=>{N({category:"",count:1})};return(0,s.jsxs)(n.Z,{children:[(0,s.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg  w-full relative col-span-full",children:[s.jsx("h1",{className:" text-2xl  font-bold mb-6",children:e?"Update Department":"Create Department"}),(0,s.jsxs)("form",{className:"space-y-4",onSubmit:v(U),children:[(0,s.jsxs)("div",{className:"flex gap-5 items-center justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block  text-sm font-medium",children:"Department Name"}),s.jsx("input",{type:"text",...r("name"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter department name"}),y.name&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.name.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Goal"}),s.jsx("input",{type:"text",...r("goal"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter department goal"}),y.goal&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.goal.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Category"}),(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsxs)("select",{...r("category"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${y.category?"border-high":"border-border"}`,children:[s.jsx("option",{value:"",children:"Select Category"}),B.map((e,t)=>s.jsx("option",{value:e,children:e},t))]}),s.jsx("div",{onClick:()=>z(!0),className:"mt-1 border-gray-500 border-dashed border-2 text-center rounded-md w-[45px] h-[40px] content-center text-lg font-bold cursor-pointer",children:"+"})]}),X&&(0,s.jsxs)("div",{className:"mt-2 flex gap-2",children:[s.jsx("input",{type:"text",className:"w-full px-4 py-2 rounded-lg border",placeholder:"Enter new Category",value:L,onChange:e=>V(e.target.value)}),s.jsx("button",{type:"button",onClick:()=>{""!==L.trim()&&(J(e=>[...e,L]),b("category",L),z(!1),V(""))},className:"bg-blue-500 text-white rounded-md px-4 py-2",children:"Add"})]}),y.category&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.category.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Main Tasks"}),s.jsx("textarea",{...r("mainTasks"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter main tasks",rows:1}),y.mainTasks&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.mainTasks.message})]})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Parent Department (Optional)"}),(0,s.jsxs)("select",{...r("parentDepartmentId"),className:"w-full px-4 py-2 mt-1 rounded-lg shadow-md",children:[s.jsx("option",{value:"",children:"Select a parent department"}),$&&$.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]}),y.parentDepartmentId&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.parentDepartmentId.message})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Numeric Owners"}),j.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsxs)("select",{...r(`numericOwners.${t}.category`),className:`w-full px-4 py-2 mt-1 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent border ${y.numericOwners?.[t]?.category?"border-high":"border-border"}`,children:[s.jsx("option",{value:"",children:"Select a Job Category"}),Q.map((e,t)=>s.jsx("option",{value:e,onClick:H,children:e},t))]}),y.numericOwners?.[t]?.category&&s.jsx("p",{className:"text-high mt-1 text-sm",children:y.numericOwners?.[t]?.category?.message}),s.jsx("input",{type:"number",...r(`numericOwners.${t}.count`),placeholder:"Count",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),s.jsx(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>w(t)})]},e.id)),s.jsx("button",{type:"button",onClick:()=>N({count:1,category:""}),className:"text-sm text-blue-500",children:"Add Numeric Owner"})]}),(0,s.jsxs)("div",{children:[s.jsx("div",{className:"block text-sm font-medium",children:"Supporting Files"}),s.jsx("input",{hidden:!0,id:"file-id",type:"file",multiple:!0,onChange:e=>{let t=e.target.files;if(t){let e=Array.from(t);E(t=>[...t,...e])}},className:"w-full px-4 py-2 mt-1 rounded-lg"}),Z.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[s.jsx("span",{children:e.name}),s.jsx(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>O(t)})]},t)),s.jsx("label",{htmlFor:"file-id",className:"text-sm text-blue-500 cursor-pointer",children:"Attach Supporting File"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Required Reports"}),q.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[s.jsx("input",{type:"text",...r(`requiredReports.${t}.name`),placeholder:"Report Name",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),s.jsx("input",{type:"file",placeholder:"Template File",className:"w-full px-4 py-2 mt-1 rounded-lg border",onChange:e=>{let r=e.target.files?.[0];r&&b(`requiredReports.${t}.templateFile`,r.name)}}),s.jsx(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>_(t)})]},e.id)),s.jsx("button",{type:"button",onClick:()=>k({name:"",templateFile:""}),className:"text-sm text-blue-500",children:"Add Required Report"})]}),(0,s.jsxs)("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Development Programs"}),P.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[s.jsx("input",{type:"text",...r(`developmentPrograms.${t}.programName`),placeholder:"Program Name",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),s.jsx("input",{type:"text",...r(`developmentPrograms.${t}.objective`),placeholder:"Objective",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),s.jsx("input",{type:"file",placeholder:"Program File",className:"w-full px-4 py-2 mt-1 rounded-lg border",onChange:e=>{let r=e.target.files?.[0];r&&b(`developmentPrograms.${t}.programFile`,r.name)}}),s.jsx("textarea",{...r(`developmentPrograms.${t}.notes`),placeholder:"Notes",className:"w-full px-4 py-2 mt-1 rounded-lg border",rows:1}),s.jsx(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>C(t)})]},e.id)),s.jsx("button",{type:"button",onClick:()=>R({programName:"",objective:"",notes:"",programFile:""}),className:"text-sm text-blue-500",children:"Add Development Program"})]}),s.jsx("button",{type:"submit",className:`w-full py-2 mt-4 bg-[#413d99] text-white rounded-lg font-bold hover:bg-opacity-90 transition duration-200 ${I?"opacity-50 cursor-not-allowed":""}`,disabled:I,children:I?e?"Updating...":"Creating...":e?"Update Department":"Create Department"}),T&&s.jsx("p",{className:"text-high mt-2 text-center",children:G+""}),K&&s.jsx("p",{className:"text-low mt-2 text-center",children:"Successful"})]})]}),s.jsx(i.Z,{open:S.open,message:S.message,severity:S.severity,onClose:()=>D(e=>({...e,open:!1}))})]})}},1191:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(326);r(7577);var a=r(2375),i=r(708);let n=({open:e,message:t,severity:r,onClose:n})=>{let o=(e,t)=>{"clickaway"!==t&&n()};return s.jsx(a.Z,{open:e,autoHideDuration:2e3,onClose:o,children:s.jsx(i.Z,{onClose:o,severity:r,variant:"filled",sx:{width:"100%"},children:t})})}},5715:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var s=r(4976),a=r(119),i=r(4099),n=r(6562);let o=({endpoint:e,onSuccessMessage:t,invalidateQueryKeys:r=[],options:o})=>{let l=(0,s.NL)(),d=async t=>(await i.Z.post(`http://ec2-35-173-139-149.compute-1.amazonaws.com${e}`,t,{headers:{Authorization:`Bearer ${n.Z.get("access_token")}`}})).data;return(0,a.D)({mutationFn:d,onSuccess:e=>{t&&console.log(t,e),r.forEach(e=>{l.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...o})}},5342:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var s=r(4412),a=r(4099),i=r(6562);let n=({queryKey:e,url:t,setSnackbarConfig:r,nestedData:n=!1,...o})=>(0,s.a)({queryKey:e,queryFn:async()=>{try{let e=await a.Z.get(t,{headers:{Authorization:`Bearer ${i.Z.get("access_token")}`}});return n?e.data.data:e.data}catch(e){throw a.Z.isAxiosError(e)&&e.response?r({open:!0,message:`Error: ${e.response.data.message||"An error occurred"}`,severity:"error"}):r({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...o})},7567:(e,t,r)=>{"use strict";r.d(t,{$:()=>i,a:()=>a});var s=r(123);let a=s.Ry().shape({name:s.Z_().required("Department name is required"),description:s.Z_().optional(),goal:s.Z_().required("Goal is required"),category:s.Z_().required("Category is required"),mainTasks:s.Z_().required("Main tasks are required"),parentDepartmentId:s.Z_().nullable().default(void 0),numericOwners:s.IX().of(s.Ry().shape({category:s.Z_(),count:s.Rx()})),supportingFiles:s.IX().of(s.nK()).notRequired(),requiredReports:s.IX().of(s.Ry().shape({name:s.Z_(),templateFile:s.Z_()})),developmentPrograms:s.IX().of(s.Ry().shape({programName:s.Z_(),objective:s.Z_(),notes:s.Z_(),programFile:s.Z_()}))}),i=s.Ry().shape({name:s.Z_().required("Department name is required"),description:s.Z_().required("Description is required"),parentDepartmentId:s.Z_().transform(e=>""===e?void 0:e).nullable().default(void 0)})},3537:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(9510),a=r(7366);r(1159);let i=()=>s.jsx("div",{children:s.jsx(a.Z,{})})},6898:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(8570).createProxy)(String.raw`E:\Projects Repository\task_manager\src\app\departments\add-department\page.tsx#default`)},7988:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(9510),a=r(7366);r(1159);let i=()=>s.jsx("div",{children:s.jsx(a.Z,{})})},119:(e,t,r)=>{"use strict";r.d(t,{D:()=>u});var s=r(7577),a=r(1180),i=r(2113),n=r(4351),o=r(3341),l=class extends n.l{#e;#t=void 0;#r;#s;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#r?.state.status==="pending"&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#a(),this.#i()}mutate(e,t){return this.#s=t,this.#r?.removeObserver(this),this.#r=this.#e.getMutationCache().build(this.#e,this.options),this.#r.addObserver(this),this.#r.execute(e)}#a(){let e=this.#r?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){i.V.batch(()=>{if(this.#s&&this.hasListeners()){let t=this.#t.variables,r=this.#t.context;e?.type==="success"?(this.#s.onSuccess?.(e.data,t,r),this.#s.onSettled?.(e.data,null,t,r)):e?.type==="error"&&(this.#s.onError?.(e.error,t,r),this.#s.onSettled?.(void 0,e.error,t,r))}this.listeners.forEach(e=>{e(this.#t)})})}},d=r(4976),c=r(8613);function u(e,t){let r=(0,d.NL)(t),[a]=s.useState(()=>new l(r,e));s.useEffect(()=>{a.setOptions(e)},[a,e]);let n=s.useSyncExternalStore(s.useCallback(e=>a.subscribe(i.V.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),o=s.useCallback((e,t)=>{a.mutate(e,t).catch(c.Z)},[a]);if(n.error&&(0,c.L)(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:o,mutateAsync:n.mutate}}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[309,644,899,412,260],()=>r(3764));module.exports=s})();