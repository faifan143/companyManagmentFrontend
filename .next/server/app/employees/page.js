(()=>{var e={};e.id=847,e.ids=[847],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},667:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>c,pages:()=>u,routeModule:()=>m,tree:()=>d}),s(4058),s(6580),s(2029),s(1930),s(5866);var r=s(3191),a=s(8716),i=s(7922),o=s.n(i),n=s(5231),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);s.d(t,l);let d=["",{children:["employees",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,4058)),"E:\\Projects Repository\\task_manager\\src\\app\\employees\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(s.bind(s,6580)),"E:\\Projects Repository\\task_manager\\src\\app\\employees\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"E:\\Projects Repository\\task_manager\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(s.bind(s,1930)),"E:\\Projects Repository\\task_manager\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],u=["E:\\Projects Repository\\task_manager\\src\\app\\employees\\page.tsx"],c="/employees/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/employees/page",pathname:"/employees",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5145:(e,t,s)=>{Promise.resolve().then(s.bind(s,3441))},3441:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>q});var r=s(326),a=s(5342),i=s(4449),o=s(8139),n=s(4099),l=s(6562),d=s(5047),u=s(7577),c=s(1191);let p=({selectedOption:e})=>{let t=(0,i.D)("admin"),[s,p]=(0,u.useState)({open:!1,message:"",severity:"success"}),{data:m,isLoading:x,refetch:h}=(0,a.Z)({queryKey:["employees",e],url:`http://ec2-35-173-139-149.compute-1.amazonaws.com/emp/${e}`,setSnackbarConfig:p}),y=(0,d.useRouter)(),b=e=>{sessionStorage.setItem("employeeData",JSON.stringify(e)),y.push("/employees/add-employee")},g=async e=>{try{await n.Z.delete(`https://ec2-35-173-139-149.compute-1.amazonaws.com/emp/delete/${e}`,{headers:{Authorization:"Bearer "+l.Z.get("access_token")}}),h()}catch(e){console.error("Error deleting employee:",e)}};return x?r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:r.jsx(o.default,{size:100})}):m&&0!=m.length?(0,r.jsxs)("div",{className:"bg-[#f0f4f9] rounded-xl shadow-md p-4 flex flex-col space-y-4 col-span-12 ",children:[m&&m.length>0?r.jsx("div",{className:"overflow-x-auto rounded-lg shadow-md",children:(0,r.jsxs)("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[r.jsx("thead",{className:"bg-gray-200",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Name"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"DOB"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Phone"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Email"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Address"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Department"}),r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Job"}),t&&r.jsx("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Actions"})]})}),r.jsx("tbody",{children:m.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-100 transition-colors",children:[r.jsx("td",{className:"text-center  py-3 px-4",children:e.name}),r.jsx("td",{className:"text-center  py-3 px-4",children:new Date(e.dob).toLocaleDateString()}),r.jsx("td",{className:"text-center  py-3 px-4",children:e.phone}),r.jsx("td",{className:"text-center  py-3 px-4",children:e.email}),r.jsx("td",{className:"text-center  py-3 px-4",children:e.address}),r.jsx("td",{className:"text-center  py-3 px-4",children:e.job.department}),r.jsx("td",{className:"text-center  py-3 px-4",children:e.job.title}),t&&(0,r.jsxs)("td",{className:"text-center  py-3 px-4 flex space-x-2",children:[r.jsx("div",{onClick:()=>b(e),className:"cursor-pointer  p-2 w-16 text-xs text-center font-bold rounded-full bg-green-100 hover:bg-green-500 hover:text-green-100 text-green-500",children:"edit"}),r.jsx("div",{className:"cursor-pointer  p-2 w-16 text-xs text-center font-bold rounded-full bg-red-100 text-red-500 hover:text-red-100 hover:bg-red-500",onClick:()=>g(e.id),children:"delete"})]})]},e.id))})]})}):r.jsx("p",{className:"text-center text-gray-600 mt-4",children:"No employees found."}),r.jsx(c.Z,{open:s.open,message:s.message,severity:s.severity,onClose:()=>p(e=>({...e,open:!1}))})]}):r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:"No Employees"})};var m=s(4660),x=s(5715),h=s(2957),y=s(1774),b=s(4723),g=s(4173),f=s.n(g);let j="ec2-35-173-139-149.compute-1.amazonaws.com",v=({isOpen:e,onClose:t,employeeData:s})=>{let{register:i,handleSubmit:o,formState:{errors:n},reset:l}=(0,b.cI)({resolver:(0,y.X)(h.Z),defaultValues:s||{}}),[d,p]=(0,u.useState)(null);(0,u.useEffect)(()=>{s?l(s):l()},[s,l]);let[m,g]=(0,u.useState)({open:!1,message:"",severity:"success"}),v=s?`/emp/update/${s.id}`:"/emp/create",{mutate:q,isPending:_,isSuccess:N,isError:w,error:E}=(0,x.s)({endpoint:v,onSuccessMessage:"Employee added successfully!",invalidateQueryKeys:["employees"]});(0,u.useEffect)(()=>{N?(g({open:!0,message:s?"Employee updated successfully!":"Employee created successfully!",severity:"success"}),l()):w&&(console.error("Error creating/updating employee:",E),p(E+""||"Failed to process the request. Please try again."))},[s,E,w,N,l]);let Z=async e=>{p(null),q({name:e.name,dob:e.dob,phone:e.phone,email:e.email,address:e.address,department_id:e.department_id,job_id:e.job_id,password:!s&&e.password}),setInterval(t,3e3)},{data:P}=(0,a.Z)({queryKey:["departments"],url:`http://${j}/department/get-departments`,setSnackbarConfig:g}),{data:R}=(0,a.Z)({queryKey:["jobTitles"],url:`http://${j}/job-titles/get-job-titles`,setSnackbarConfig:g});return(0,r.jsxs)(f(),{isOpen:e,onRequestClose:t,ariaHideApp:!1,contentLabel:"Create/Update Employee",className:"fixed inset-0 flex items-center justify-center",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",children:[(0,r.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg max-w-md w-full relative",children:[r.jsx("button",{onClick:t,className:"absolute top-2 right-2 text-gray-700 hover:text-red-500",children:"\xd7"}),r.jsx("h1",{className:"text-center text-2xl font-bold mb-6",children:s?"Update Employee":"Create Employee"}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:o(Z),children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Name"}),r.jsx("input",{type:"text",...i("name"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.name?"border-red-500":"border-gray-300"}`,placeholder:"Enter employee name"}),n.name&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.name.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Date of Birth"}),r.jsx("input",{type:"date",...i("dob"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.dob?"border-red-500":"border-gray-300"}`,placeholder:"Enter date of birth"}),n.dob&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.dob.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Phone"}),r.jsx("input",{type:"text",...i("phone"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.phone?"border-red-500":"border-gray-300"}`,placeholder:"Enter phone number"}),n.phone&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.phone.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Email"}),r.jsx("input",{type:"email",...i("email"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter email"}),n.email&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.email.message})]}),!s&&(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Password"}),r.jsx("input",{type:"text",...i("password"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter Password"}),n.password&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.password.message})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-gray-600 text-sm font-medium",children:"Address"}),r.jsx("input",{type:"text",...i("address"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.address?"border-red-500":"border-gray-300"}`,placeholder:"Enter address"}),n.address&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.address.message})]}),(0,r.jsxs)("select",{...i("department_id"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.department_id?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select a department"}),P&&P.map(e=>r.jsx("option",{value:e.id,children:e.name},e.id))]}),n.department_id&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.department_id.message}),(0,r.jsxs)("select",{...i("job_id"),className:`w-full px-4 py-2 mt-1 rounded-lg border ${n.department_id?"border-red-500":"border-gray-300"}`,children:[r.jsx("option",{value:"",children:"Select a job title"}),R&&R.map(e=>r.jsx("option",{value:e.id,children:e.title},e.id))]}),n.job_id&&r.jsx("p",{className:"text-red-500 mt-1 text-sm",children:n.job_id.message}),r.jsx("button",{type:"submit",className:`w-full py-2 mt-4 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition duration-200 ${_?"opacity-50 cursor-not-allowed":""}`,disabled:_,children:_?s?"Updating...":"Creating...":s?"Update Employee":"Create Employee"}),d&&r.jsx("p",{className:`mt-2 text-center ${d.includes("successfully")?"text-green-500":"text-red-500"}`,children:d})]})]}),r.jsx(c.Z,{open:m.open,message:m.message,severity:m.severity,onClose:()=>g(e=>({...e,open:!1}))})]})},q=()=>{let[e,t]=(0,u.useState)(!1),[s,a]=(0,u.useState)(null),[o,n]=(0,u.useState)("get-all-emps"),l=(0,d.useRouter)(),c=(0,i.D)("admin");return(0,u.useEffect)(()=>{console.log(o)},[o]),(0,r.jsxs)(m.Z,{children:[(0,r.jsxs)("div",{className:"col-span-full flex justify-between items-center",children:[r.jsx("h1",{className:"text-3xl font-bold text-center ",children:"Employees Management"}),(0,r.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,r.jsxs)("select",{className:"bg-white border border-gray-300 rounded-lg px-4 py-2 focus:outline-none transition duration-200",value:o,onChange:e=>n(e.target.value),children:[c&&r.jsx("option",{value:"get-all-emps",children:"All Employees"}),(0,i.T)(["emp_view_specific"])&&r.jsx("option",{value:"view",children:"View Accessible Employees"}),(0,i.D)("primary_user")&&r.jsx("option",{value:"get-my-emps",children:"My Department Employees"})]}),c&&r.jsx("button",{className:"bg-[#1b1a40] text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition duration-200",onClick:()=>{a(null),l.push("/employees/add-employee")},children:"Add Employee"})]})]}),r.jsx(p,{selectedOption:o}),r.jsx(v,{isOpen:e,onClose:()=>t(!1),employeeData:s})]})}},1191:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s(326);s(7577);var a=s(2375),i=s(708);let o=({open:e,message:t,severity:s,onClose:o})=>{let n=(e,t)=>{"clickaway"!==t&&o()};return r.jsx(a.Z,{open:e,autoHideDuration:2e3,onClose:n,children:r.jsx(i.Z,{onClose:n,severity:s,variant:"filled",sx:{width:"100%"},children:t})})}},5715:(e,t,s)=>{"use strict";s.d(t,{s:()=>n});var r=s(4976),a=s(119),i=s(4099),o=s(6562);let n=({endpoint:e,onSuccessMessage:t,invalidateQueryKeys:s=[],options:n})=>{let l=(0,r.NL)(),d=async t=>(await i.Z.post(`http://ec2-35-173-139-149.compute-1.amazonaws.com${e}`,t,{headers:{Authorization:`Bearer ${o.Z.get("access_token")}`}})).data;return(0,a.D)({mutationFn:d,onSuccess:e=>{t&&console.log(t,e),s.forEach(e=>{l.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...n})}},5342:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var r=s(4412),a=s(4099),i=s(6562);let o=({queryKey:e,url:t,setSnackbarConfig:s,nestedData:o=!1,...n})=>(0,r.a)({queryKey:e,queryFn:async()=>{try{let e=await a.Z.get(t,{headers:{Authorization:`Bearer ${i.Z.get("access_token")}`}});return o?e.data.data:e.data}catch(e){throw a.Z.isAxiosError(e)&&e.response?s({open:!0,message:`Error: ${e.response.data.message||"An error occurred"}`,severity:"error"}):s({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...n})},2957:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i,d:()=>a});var r=s(123);let a=r.Ry().shape({id:r.Z_().optional(),name:r.Z_().required("Employee name is required"),national_id:r.Z_().required("National Id is required"),gender:r.Z_().required("Gender is required"),marital_status:r.Z_().required("Marital status is required"),address:r.Z_().required("Address is required"),employment_date:r.Z_().required("Employment date is required").matches(/^\d{4}-\d{2}-\d{2}$/,"Employment date must be in YYYY-MM-DD format"),base_salary:r.Rx().required("Base salary is required"),dob:r.Z_().required("Date of birth is required").matches(/^\d{4}-\d{2}-\d{2}$/,"Date of birth must be in YYYY-MM-DD format"),phone:r.Z_().required("Phone number is required"),email:r.Z_().required("Email is required").email("Invalid email format"),password:r.Z_().required("password is required"),department_id:r.Z_().required("Department ID is required"),job_id:r.Z_().required("Job ID is required"),job_tasks:r.Z_().required("Job tasks is required"),emergency_contact:r.Z_().required("emergency contact is required"),legal_documents:r.IX().of(r.Ry().shape({name:r.Z_().required("Document name is required"),validity:r.Z_().nullable(),file:r.Z_().nullable()})).optional(),certifications:r.IX().of(r.Ry().shape({certificate_name:r.Z_().required("Certificate name is required"),date:r.Z_().nullable(),grade:r.Z_().required("Grade is required"),file:r.Z_().nullable()})).optional(),allowances:r.IX().of(r.Ry().shape({allowance_type:r.Z_().required("Allowance type is required"),amount:r.Rx().required("Allowance amount is required").positive("Amount must be a positive number")})).optional(),incentives:r.IX().of(r.Ry().shape({description:r.Z_().required("Incentive description is required"),amount:r.Rx().required("Incentive amount is required").positive("Amount must be a positive number")})).optional(),bank_accounts:r.IX().of(r.Ry().shape({bank_name:r.Z_().required("Bank name is required"),account_number:r.Z_().required("Account number is required").matches(/^\d+$/,"Account number must contain only digits")})).optional(),evaluations:r.IX().of(r.Ry().shape({evaluation_type:r.Z_().required("Evaluation type is required"),description:r.Z_().required("Evaluation description is required"),plan:r.Z_().required("Plan is required")})).optional()}),i=r.Ry().shape({name:r.Z_().required("Employee name is required"),dob:r.hT().required("Date of birth is required").typeError("Invalid date format"),phone:r.Z_().required("Phone number is required"),password:r.Z_(),email:r.Z_().required("Email is required").email("Invalid email format"),address:r.Z_().required("Address is required"),department_id:r.Z_().required("Department ID is required"),job_id:r.Z_().required("Job ID is required")})},4449:(e,t,s)=>{"use strict";s.d(t,{D:()=>i,T:()=>a});var r=s(5842);function a(e){let t=(0,r.v9)(e=>e.user.userInfo?.job.permissions||[]);return e.some(e=>t.includes(e))}function i(e){return e==(0,r.v9)(e=>e.user.role)}},6580:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(9510),a=s(7366);s(1159);let i=()=>r.jsx("div",{children:r.jsx(a.Z,{})})},4058:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`E:\Projects Repository\task_manager\src\app\employees\page.tsx#default`)},119:(e,t,s)=>{"use strict";s.d(t,{D:()=>c});var r=s(7577),a=s(1180),i=s(2113),o=s(4351),n=s(3341),l=class extends o.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,n.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,n.Ym)(t.mutationKey)!==(0,n.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#i()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#i(e){i.V.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s),this.#r.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s),this.#r.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#t)})})}},d=s(4976),u=s(8613);function c(e,t){let s=(0,d.NL)(t),[a]=r.useState(()=>new l(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);let o=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(i.V.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),n=r.useCallback((e,t)=>{a.mutate(e,t).catch(u.Z)},[a]);if(o.error&&(0,u.L)(a.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:n,mutateAsync:o.mutate}}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[309,644,899,412,260],()=>s(667));module.exports=r})();