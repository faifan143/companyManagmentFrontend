(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1523],{7475:function(e,t,s){Promise.resolve().then(s.bind(s,4470))},4470:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var i=s(7437),r=s(9671),a=s(2299),l=s(9376),n=s(7753),c=s(2265),o=s(9343),d=s(7300),u=s(7309),m=s(8577);let p="ec2-35-173-139-149.compute-1.amazonaws.com",b=["emp_search_and_view","emp_manage_files","emp_add","emp_update","emp_delete","emp_view_specific","job_title_search_and_view","job_title_manage_files","job_title_add","job_title_update","job_title_delete","job_title_view_specific","job_title_category_search_and_view","job_title_category_manage_files","job_title_category_add","job_title_category_update","job_title_category_delete","department_search_and_view","department_manage_files","department_add","department_update","department_delete","department_view_specific","permission_search_and_view","permission_add","permission_update","permission_delete","electronic_transaction_search_and_view","electronic_transaction_manage_files","electronic_transaction_add","electronic_transaction_update","electronic_transaction_delete","task_search_and_view","task_manage_files","task_add","task_update","task_delete"].map(e=>({value:e,label:e.replace(/_/g," ").toUpperCase()}));var _=()=>{let[e,t]=(0,c.useState)("default"),[s,_]=(0,c.useState)([]),[h,g]=(0,c.useState)([]),[f,x]=(0,c.useState)([]),[v,j]=(0,c.useState)([]),[y,w]=(0,c.useState)(null),[N,q]=(0,c.useState)(!1),{register:E,handleSubmit:k,formState:{errors:Z},reset:S,setValue:C}=(0,o.cI)({resolver:(0,n.X)(m.h),defaultValues:y||{name:"",title:"",grade_level:"",category:"",description:"",responsibilities:[],permissions:[],department_id:"",is_manager:!1,accessibleDepartments:[],accessibleEmps:[],accessibleJobTitles:[]}});(0,c.useEffect)(()=>{console.log("Validation errors:",Z)},[Z]),(0,c.useEffect)(()=>{let e=sessionStorage.getItem("jobData");if(e){let t=JSON.parse(e),s={...t,department_id:t.department.id,category:t.category.id};w(s),S(s),_(t.permissions||[]),q(t.is_manager)}},[S]),c.useEffect(()=>{y?S(y):S()},[y,S]);let[J,D]=(0,c.useState)({open:!1,message:"",severity:"success"}),T=y?"/job-titles/update/".concat(y.id):"/job-titles/create",{mutate:P,isPending:I,isSuccess:A,isError:M,error:R}=(0,l.s)({endpoint:T,onSuccessMessage:"Job Title added successfully!",invalidateQueryKeys:["jobTitles"]}),X=async e=>{console.log("Form data before submission:",{...e,permissions:s,is_manager:N,accessibleDepartments:h,accessibleEmps:f,accessibleJobTitles:v}),P({...e,permissions:s,is_manager:N,accessibleDepartments:h,accessibleEmps:f,accessibleJobTitles:v})};(0,c.useEffect)(()=>{A?(sessionStorage.clear(),S({id:"",name:"",title:"",grade_level:"",description:"",responsibilities:[],permissions:[],department_id:"",accessibleDepartments:[],accessibleEmps:[],accessibleJobTitles:[],category:"",is_manager:!1}),D({open:!0,message:y?"Job Title updated successfully!":"Job Title created successfully!",severity:"success"})):M&&console.error("Failed to create/update the job title",R)},[R,M,A,y,S]);let{data:L}=(0,d.Z)({queryKey:["departments"],url:"http://".concat(p,"/department/get-departments"),setSnackbarConfig:D}),{data:O}=(0,d.Z)({queryKey:["categories"],url:"http://".concat(p,"/job-categories"),setSnackbarConfig:D});(0,c.useEffect)(()=>{console.log(h)},[h]),(0,c.useEffect)(()=>{console.log(f)},[f]),(0,c.useEffect)(()=>{console.log(v)},[v]);let z=L?L.map(e=>({value:e.id,label:e.name})):[];return(0,c.useEffect)(()=>{let e=()=>{S(),sessionStorage.removeItem("jobData")};return window.addEventListener("beforeunload",e),window.addEventListener("popstate",e),()=>{window.removeEventListener("beforeunload",e),window.removeEventListener("popstate",e)}},[S]),(0,i.jsxs)(a.Z,{children:[(0,i.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg col-span-12 w-full relative",children:[(0,i.jsx)("h1",{className:"text-center text-2xl  font-bold mb-6",children:y?"Update Job Title":"Create Job Title"}),(0,i.jsxs)("form",{className:"space-y-4",onSubmit:k(X),children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Job Title Name"}),(0,i.jsx)("input",{type:"text",...E("name"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.name?"border-high":"border-border"),placeholder:"Enter job title name"}),Z.name&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.name.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Title"}),(0,i.jsx)("input",{type:"text",...E("title"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.title?"border-high":"border-border"),placeholder:"Enter job title"}),Z.title&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.title.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Description"}),(0,i.jsx)("input",{type:"text",...E("description"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.description?"border-high":"border-border"),placeholder:"Enter job description"}),Z.description&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.description.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Grade Level"}),(0,i.jsx)("input",{type:"text",...E("grade_level"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.grade_level?"border-high":"border-border"),placeholder:"Enter grade level"}),Z.grade_level&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.grade_level.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Responsibilities"}),(0,i.jsx)("textarea",{className:"w-full px-4 py-2 mt-1 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.responsibilities?"border-high":"border-border"),placeholder:"Enter responsibilities (comma-separated)",rows:3,onChange:e=>{let t=e.target.value.split(",");console.log(t),C("responsibilities",t)}}),Z.responsibilities&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.responsibilities.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium",children:"Permissions Mode"}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"radio",value:"default",checked:"default"===e,onChange:()=>{t("default"),_([]),g([]),x([]),j([])}}),"Default"]}),(0,i.jsxs)("label",{children:[(0,i.jsx)("input",{type:"radio",value:"custom",checked:"custom"===e,onChange:()=>t("custom")}),"Custom"]})]})]}),"custom"===e&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium",children:"Select Permissions"}),(0,i.jsx)(u.ZP,{isMulti:!0,value:b.filter(e=>s.includes(e.value)),options:b,onChange:e=>{let t=e.map(e=>e.value);_(t),t.includes("department_view_specific")?g(h):g([]),t.includes("emp_view_specific")?x(f):x([]),t.includes("job_title_view_specific")?j(v):j([])},className:"mt-1",placeholder:"Select Permissions..."})]}),s.includes("department_view_specific")&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium",children:"Specific Department"}),(0,i.jsx)(u.ZP,{...E("accessibleDepartments"),isMulti:!0,value:z.filter(e=>h.includes(e.value)),options:z,onChange:e=>g(e.map(e=>e.value)),className:"mt-1",placeholder:"Select Accessible Departments..."})]}),s.includes("emp_view_specific")&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium",children:"Specific Employee"}),(0,i.jsx)(u.ZP,{...E("accessibleEmps"),isMulti:!0,value:z.filter(e=>f.includes(e.value)),options:z,onChange:e=>x(e.map(e=>e.value)),className:"mt-1",placeholder:"Select Accessible Employees..."})]}),s.includes("job_title_view_specific")&&(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium",children:"Specific Job Title"}),(0,i.jsx)(u.ZP,{...E("accessibleJobTitles"),isMulti:!0,value:z.filter(e=>v.includes(e.value)),options:z,onChange:e=>j(e.map(e=>e.value)),className:"mt-1",placeholder:"Select Accessible Job Titles..."})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Job Category"}),(0,i.jsxs)("select",{...E("category"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.category?"border-high":"border-border"),children:[(0,i.jsx)("option",{value:"",children:"Select a Job Category"}),O&&O.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]}),Z.category&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.category.message})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block  text-sm font-medium",children:"Parent Department (Optional)"}),(0,i.jsxs)("select",{...E("department_id"),className:"w-full px-4 py-2 mt-1 rounded-lg     focus:outline-none focus:ring-2 focus:ring-accent border ".concat(Z.department_id?"border-high":"border-border"),children:[(0,i.jsx)("option",{value:"",children:"Select a parent department"}),L&&L.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]}),Z.department_id&&(0,i.jsx)("p",{className:"text-high mt-1 text-sm",children:Z.department_id.message})]}),(0,i.jsxs)("div",{className:"flex items-center mt-2",children:[(0,i.jsx)("label",{className:"text-sm font-medium mr-2",children:"Is Manager?"}),(0,i.jsx)("input",{type:"checkbox",checked:N,onChange:()=>q(!N),className:"form-checkbox text-blue-600 h-5 w-5"})]}),(0,i.jsx)("button",{type:"submit",className:"w-full py-2 mt-4 bg-[#413d99] text-white rounded-lg font-bold hover:bg-opacity-90 transition duration-200 ".concat(I?"opacity-50 cursor-not-allowed":""),disabled:I,children:I?y?"Updating...":"Creating...":y?"Update Job Title":"Create Job Title"}),M&&(0,i.jsx)("p",{className:"text-high mt-2 text-center",children:R+""})]})]}),(0,i.jsx)(r.Z,{open:J.open,message:J.message,severity:J.severity,onClose:()=>D(e=>({...e,open:!1}))})]})}},9671:function(e,t,s){"use strict";var i=s(7437);s(2265);var r=s(9175),a=s(5740);t.Z=e=>{let{open:t,message:s,severity:l,onClose:n}=e,c=(e,t)=>{"clickaway"!==t&&n()};return(0,i.jsx)(r.Z,{open:t,autoHideDuration:2e3,onClose:c,children:(0,i.jsx)(a.Z,{onClose:c,severity:l,variant:"filled",sx:{width:"100%"},children:s})})}},2299:function(e,t,s){"use strict";var i=s(7437);s(2265),t.Z=e=>{let{children:t,extraStyle:s}=e;return(0,i.jsx)("div",{className:"sm:w-full mobile-grid sm:desktop-grid  "+s,children:t})}},9376:function(e,t,s){"use strict";s.d(t,{s:function(){return n}});var i=s(3191),r=s(5524),a=s(8472),l=s(2649);let n=e=>{let{endpoint:t,onSuccessMessage:s,invalidateQueryKeys:n=[],options:c}=e,o=(0,i.NL)(),d=async e=>(await a.Z.post("http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com").concat(t),e,{headers:{Authorization:"Bearer ".concat(l.Z.get("access_token"))}})).data;return(0,r.D)({mutationFn:d,onSuccess:e=>{s&&console.log(s,e),n.forEach(e=>{o.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...c})}},7300:function(e,t,s){"use strict";var i=s(932),r=s(8472),a=s(2649);t.Z=e=>{let{queryKey:t,url:s,setSnackbarConfig:l,nestedData:n=!1,...c}=e;return(0,i.a)({queryKey:t,queryFn:async()=>{try{let e=await r.Z.get(s,{headers:{Authorization:"Bearer ".concat(a.Z.get("access_token"))}});return n?e.data.data:e.data}catch(e){throw r.Z.isAxiosError(e)&&e.response?l({open:!0,message:"Error: ".concat(e.response.data.message||"An error occurred"),severity:"error"}):l({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...c})}},8577:function(e,t,s){"use strict";s.d(t,{Y:function(){return r},h:function(){return a}});var i=s(4245);let r=i.Ry().shape({name:i.Z_().required("Category name is required"),description:i.Z_().required("Description is required"),required_education:i.Z_().required("Required education is required"),required_experience:i.Z_().required("Required experience is required"),required_skills:i.IX(i.Z_().required("Skill is required")).min(1,"At least one skill is required")}),a=i.Ry().shape({name:i.Z_().required("Job title name is required"),title:i.Z_().required("Title is required"),grade_level:i.Z_().required("Grade level is required"),description:i.Z_().required("Description is required"),responsibilities:i.IX(i.Z_().required("Responsibilities are required")).required(),permissions:i.IX(i.Z_().required("Each permission must be a string")).required("Permissions are required"),department_id:i.Z_().required("Department ID is required"),category:i.Z_().required("Job Category is required"),is_manager:i.O7().notRequired(),accessibleDepartments:i.IX(i.Z_()).nullable(),accessibleEmps:i.IX(i.Z_()).nullable(),accessibleJobTitles:i.IX(i.Z_()).nullable()})}},function(e){e.O(0,[7034,5907,4186,1336,2280,932,1495,2971,7023,1744],function(){return e(e.s=7475)}),_N_E=e.O()}]);