(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6703],{386:function(e,t,s){Promise.resolve().then(s.bind(s,6428))},6428:function(e,t,s){"use strict";s.r(t);var r=s(7437),a=s(9094),n=s(9671),i=s(2299),o=s(9376),l=s(7300),c=s(5248),d=s(7753),u=s(6648),m=s(2265),p=s(9343);let h="ec2-35-173-139-149.compute-1.amazonaws.com";t.default=()=>{let[e,t]=(0,m.useState)(null),{register:s,getValues:x,control:g,formState:{errors:b},setValue:f,reset:v,handleSubmit:y}=(0,p.cI)({resolver:(0,d.X)(c.a),defaultValues:{}});(0,m.useEffect)(()=>{let e=sessionStorage.getItem("departmentData");if(e){let s=JSON.parse(e);t(s),v(s)}},[v]);let{fields:j,append:N,remove:w}=(0,p.Dq)({control:g,name:"numericOwners"}),{fields:k,append:C,remove:O}=(0,p.Dq)({control:g,name:"requiredReports"}),{fields:Z,append:_,remove:R}=(0,p.Dq)({control:g,name:"developmentPrograms"}),[S,q]=(0,m.useState)([]),D=e=>{q(t=>t.filter((t,s)=>s!==e))};(0,m.useEffect)(()=>{e?v(e):v()},[e,v]);let[E,M]=(0,m.useState)({open:!1,message:"",severity:"success"}),F=e?"/department/updateDepartment/".concat(e.id):"/department/create-department",{data:P}=(0,l.Z)({queryKey:["departments"],url:"http://".concat(h,"/department/get-departments"),setSnackbarConfig:M}),{data:I}=(0,l.Z)({queryKey:["categories"],url:"http://".concat(h,"/job-categories"),setSnackbarConfig:M}),{mutate:A,isPending:K,isSuccess:H,isError:T,error:W}=(0,o.s)({endpoint:F,onSuccessMessage:"Departments added successfully!",invalidateQueryKeys:["departments"]}),L=async()=>{let e=x();e.supportingFiles=S.map(e=>e.name),console.log("Form data with files:",e),A(e)};(0,m.useEffect)(()=>{H?(sessionStorage.clear(),M({open:!0,message:e?"Department updated successfully!":"Department created successfully!",severity:"success"}),v({id:"",parentDepartmentId:"",description:"",name:"",goal:"",category:"",mainTasks:"",numericOwners:[],supportingFiles:[],requiredReports:[],developmentPrograms:[]}),q([])):T&&console.error("Failed to create/update the department",W)},[e,W,T,H,v]);let[U,X]=(0,m.useState)(!1),[z,V]=(0,m.useState)(""),[B,G]=(0,m.useState)(["primary-department","secondary-department","sub-department"]),[J,Q]=(0,m.useState)([]);(0,m.useEffect)(()=>{I&&Q(I.map(e=>e.name))},[I]);let Y=()=>{N({category:"",count:1})};return(0,r.jsxs)(i.Z,{children:[(0,r.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg  w-full relative col-span-full",children:[(0,r.jsx)("h1",{className:" text-2xl  font-bold mb-6",children:e?"Update Department":"Create Department"}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:y(L),children:[(0,r.jsxs)("div",{className:"flex gap-5 items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block  text-sm font-medium",children:"Department Name"}),(0,r.jsx)("input",{type:"text",...s("name"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter department name"}),b.name&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:b.name.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Goal"}),(0,r.jsx)("input",{type:"text",...s("goal"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter department goal"}),b.goal&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:b.goal.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Category"}),(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsxs)("select",{...s("category"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(b.category?"border-high":"border-border"),children:[(0,r.jsx)("option",{value:"",children:"Select Category"}),B.map((e,t)=>(0,r.jsx)("option",{value:e,children:e},t))]}),(0,r.jsx)("div",{onClick:()=>X(!0),className:"mt-1 border-gray-500 border-dashed border-2 text-center rounded-md w-[45px] h-[40px] content-center text-lg font-bold cursor-pointer",children:"+"})]}),U&&(0,r.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,r.jsx)("input",{type:"text",className:"w-full px-4 py-2 rounded-lg border",placeholder:"Enter new Category",value:z,onChange:e=>V(e.target.value)}),(0,r.jsx)("button",{type:"button",onClick:()=>{""!==z.trim()&&(G(e=>[...e,z]),f("category",z),X(!1),V(""))},className:"bg-blue-500 text-white rounded-md px-4 py-2",children:"Add"})]}),b.category&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:b.category.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Main Tasks"}),(0,r.jsx)("textarea",{...s("mainTasks"),className:"w-full px-4 py-2 mt-1 rounded-lg border",placeholder:"Enter main tasks",rows:1}),b.mainTasks&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:b.mainTasks.message})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Parent Department (Optional)"}),(0,r.jsxs)("select",{...s("parentDepartmentId"),className:"w-full px-4 py-2 mt-1 rounded-lg shadow-md",children:[(0,r.jsx)("option",{value:"",children:"Select a parent department"}),P&&P.map(e=>(0,r.jsx)("option",{value:e.id,children:e.name},e.id))]}),b.parentDepartmentId&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:b.parentDepartmentId.message})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Numeric Owners"}),j.map((e,t)=>{var n,i,o,l,c,d,m;return(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsxs)("select",{...s("numericOwners.".concat(t,".category")),className:"w-full px-4 py-2 mt-1 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent border ".concat((null===(i=b.numericOwners)||void 0===i?void 0:null===(n=i[t])||void 0===n?void 0:n.category)?"border-high":"border-border"),children:[(0,r.jsx)("option",{value:"",children:"Select a Job Category"}),J.map((e,t)=>(0,r.jsx)("option",{value:e,onClick:Y,children:e},t))]}),(null===(l=b.numericOwners)||void 0===l?void 0:null===(o=l[t])||void 0===o?void 0:o.category)&&(0,r.jsx)("p",{className:"text-high mt-1 text-sm",children:null===(m=b.numericOwners)||void 0===m?void 0:null===(d=m[t])||void 0===d?void 0:null===(c=d.category)||void 0===c?void 0:c.message}),(0,r.jsx)("input",{type:"number",...s("numericOwners.".concat(t,".count")),placeholder:"Count",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),(0,r.jsx)(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>w(t)})]},e.id)}),(0,r.jsx)("button",{type:"button",onClick:()=>N({count:1,category:""}),className:"text-sm text-blue-500",children:"Add Numeric Owner"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"block text-sm font-medium",children:"Supporting Files"}),(0,r.jsx)("input",{hidden:!0,id:"file-id",type:"file",multiple:!0,onChange:e=>{let t=e.target.files;if(t){let e=Array.from(t);q(t=>[...t,...e])}},className:"w-full px-4 py-2 mt-1 rounded-lg"}),S.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>D(t)})]},t)),(0,r.jsx)("label",{htmlFor:"file-id",className:"text-sm text-blue-500 cursor-pointer",children:"Attach Supporting File"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Required Reports"}),k.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)("input",{type:"text",...s("requiredReports.".concat(t,".name")),placeholder:"Report Name",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),(0,r.jsx)("input",{type:"file",placeholder:"Template File",className:"w-full px-4 py-2 mt-1 rounded-lg border",onChange:e=>{var s;let r=null===(s=e.target.files)||void 0===s?void 0:s[0];r&&f("requiredReports.".concat(t,".templateFile"),r.name)}}),(0,r.jsx)(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>O(t)})]},e.id)),(0,r.jsx)("button",{type:"button",onClick:()=>C({name:"",templateFile:""}),className:"text-sm text-blue-500",children:"Add Required Report"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Development Programs"}),Z.map((e,t)=>(0,r.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,r.jsx)("input",{type:"text",...s("developmentPrograms.".concat(t,".programName")),placeholder:"Program Name",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),(0,r.jsx)("input",{type:"text",...s("developmentPrograms.".concat(t,".objective")),placeholder:"Objective",className:"w-full px-4 py-2 mt-1 rounded-lg border"}),(0,r.jsx)("input",{type:"file",placeholder:"Program File",className:"w-full px-4 py-2 mt-1 rounded-lg border",onChange:e=>{var s;let r=null===(s=e.target.files)||void 0===s?void 0:s[0];r&&f("developmentPrograms.".concat(t,".programFile"),r.name)}}),(0,r.jsx)("textarea",{...s("developmentPrograms.".concat(t,".notes")),placeholder:"Notes",className:"w-full px-4 py-2 mt-1 rounded-lg border",rows:1}),(0,r.jsx)(u.default,{src:a.b0,alt:"icon",width:20,height:20,className:"cursor-pointer p-1 shadow-md rounded-md text-red-500",onClick:()=>R(t)})]},e.id)),(0,r.jsx)("button",{type:"button",onClick:()=>_({programName:"",objective:"",notes:"",programFile:""}),className:"text-sm text-blue-500",children:"Add Development Program"})]}),(0,r.jsx)("button",{type:"submit",className:"w-full py-2 mt-4 bg-[#413d99] text-white rounded-lg font-bold hover:bg-opacity-90 transition duration-200 ".concat(K?"opacity-50 cursor-not-allowed":""),disabled:K,children:K?e?"Updating...":"Creating...":e?"Update Department":"Create Department"}),T&&(0,r.jsx)("p",{className:"text-high mt-2 text-center",children:W+""}),H&&(0,r.jsx)("p",{className:"text-low mt-2 text-center",children:"Successful"})]})]}),(0,r.jsx)(n.Z,{open:E.open,message:E.message,severity:E.severity,onClose:()=>M(e=>({...e,open:!1}))})]})}},9094:function(e,t,s){"use strict";s.d(t,{qZ:function(){return l},LM:function(){return i},Kc:function(){return n},tv:function(){return r},hO:function(){return o},Fl:function(){return a},b0:function(){return c}});var r={src:"/_next/static/media/home-icon.6cad6f25.svg",height:32,width:32,blurWidth:0,blurHeight:0},a={src:"/_next/static/media/tasks-icon.1b08515d.svg",height:32,width:32,blurWidth:0,blurHeight:0},n={src:"/_next/static/media/employees-icon.390dbd95.svg",height:32,width:32,blurWidth:0,blurHeight:0},i={src:"/_next/static/media/departments-icon.251fb945.svg",height:32,width:32,blurWidth:0,blurHeight:0},o={src:"/_next/static/media/jobs-icon.c6149ea0.svg",height:32,width:32,blurWidth:0,blurHeight:0},l={src:"/_next/static/media/chats-icon.28793a3d.svg",height:24,width:24,blurWidth:0,blurHeight:0},c={src:"/_next/static/media/x-icon.f6b8391d.svg",height:24,width:24,blurWidth:0,blurHeight:0}},9671:function(e,t,s){"use strict";var r=s(7437);s(2265);var a=s(9175),n=s(5740);t.Z=e=>{let{open:t,message:s,severity:i,onClose:o}=e,l=(e,t)=>{"clickaway"!==t&&o()};return(0,r.jsx)(a.Z,{open:t,autoHideDuration:2e3,onClose:l,children:(0,r.jsx)(n.Z,{onClose:l,severity:i,variant:"filled",sx:{width:"100%"},children:s})})}},2299:function(e,t,s){"use strict";var r=s(7437);s(2265),t.Z=e=>{let{children:t,extraStyle:s}=e;return(0,r.jsx)("div",{className:"sm:w-full mobile-grid sm:desktop-grid  "+s,children:t})}},9376:function(e,t,s){"use strict";s.d(t,{s:function(){return o}});var r=s(3191),a=s(5524),n=s(8472),i=s(2649);let o=e=>{let{endpoint:t,onSuccessMessage:s,invalidateQueryKeys:o=[],options:l}=e,c=(0,r.NL)(),d=async e=>(await n.Z.post("http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com").concat(t),e,{headers:{Authorization:"Bearer ".concat(i.Z.get("access_token"))}})).data;return(0,a.D)({mutationFn:d,onSuccess:e=>{s&&console.log(s,e),o.forEach(e=>{c.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...l})}},7300:function(e,t,s){"use strict";var r=s(932),a=s(8472),n=s(2649);t.Z=e=>{let{queryKey:t,url:s,setSnackbarConfig:i,nestedData:o=!1,...l}=e;return(0,r.a)({queryKey:t,queryFn:async()=>{try{let e=await a.Z.get(s,{headers:{Authorization:"Bearer ".concat(n.Z.get("access_token"))}});return o?e.data.data:e.data}catch(e){throw a.Z.isAxiosError(e)&&e.response?i({open:!0,message:"Error: ".concat(e.response.data.message||"An error occurred"),severity:"error"}):i({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...l})}},5248:function(e,t,s){"use strict";s.d(t,{$:function(){return n},a:function(){return a}});var r=s(4245);let a=r.Ry().shape({name:r.Z_().required("Department name is required"),description:r.Z_().optional(),goal:r.Z_().required("Goal is required"),category:r.Z_().required("Category is required"),mainTasks:r.Z_().required("Main tasks are required"),parentDepartmentId:r.Z_().nullable().default(void 0),numericOwners:r.IX().of(r.Ry().shape({category:r.Z_(),count:r.Rx()})),supportingFiles:r.IX().of(r.nK()).notRequired(),requiredReports:r.IX().of(r.Ry().shape({name:r.Z_(),templateFile:r.Z_()})),developmentPrograms:r.IX().of(r.Ry().shape({programName:r.Z_(),objective:r.Z_(),notes:r.Z_(),programFile:r.Z_()}))}),n=r.Ry().shape({name:r.Z_().required("Department name is required"),description:r.Z_().required("Description is required"),parentDepartmentId:r.Z_().transform(e=>""===e?void 0:e).nullable().default(void 0)})},5524:function(e,t,s){"use strict";s.d(t,{D:function(){return u}});var r=s(2265),a=s(2812),n=s(9948),i=s(9010),o=s(6298),l=class extends i.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,o.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,o.Ym)(t.mutationKey)!==(0,o.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#n(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#n()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#n(e){n.V.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,s),this.#r.onSettled?.(e.data,null,t,s)):e?.type==="error"&&(this.#r.onError?.(e.error,t,s),this.#r.onSettled?.(void 0,e.error,t,s))}this.listeners.forEach(e=>{e(this.#t)})})}},c=s(3191),d=s(7832);function u(e,t){let s=(0,c.NL)(t),[a]=r.useState(()=>new l(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);let i=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(n.V.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),o=r.useCallback((e,t)=>{a.mutate(e,t).catch(d.Z)},[a]);if(i.error&&(0,d.L)(a.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}}},function(e){e.O(0,[7034,5907,4186,1336,2280,932,1387,2971,7023,1744],function(){return e(e.s=386)}),_N_E=e.O()}]);