(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6519],{760:function(e,t,r){Promise.resolve().then(r.bind(r,4958))},4958:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var s=r(7437),a=r(7300),n=r(6716),o=r(468),c=r(6463),i=r(2265),l=r(9671);let d=e=>e?e.parentDepartmentId?"".concat(e.name):e.name:"None";var p=e=>{let{selectedOption:t}=e,[r,p]=(0,i.useState)({open:!1,message:"",severity:"success"}),{data:m,isLoading:u}=(0,a.Z)({queryKey:["departments",t],url:"view"===t?"http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com","/department/view"):"http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com","/department/get-departments"),setSnackbarConfig:p}),x=(0,n.D)("admin"),h=(0,c.useRouter)(),f=e=>{sessionStorage.setItem("departmentData",JSON.stringify(e)),h.push("/departments/add-department")};return u?(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:(0,s.jsx)(o.default,{size:100})}):m&&0!==m.length?(0,s.jsxs)("div",{className:"bg-[#f0f4f9] rounded-xl shadow-md p-4 flex flex-col space-y-4 col-span-12",children:[(0,s.jsx)("div",{className:"overflow-x-auto rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[(0,s.jsx)("thead",{className:"bg-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-[#1b1a40] text-center py-3 px-4 uppercase font-semibold text-sm",children:"Name"}),(0,s.jsx)("th",{className:"text-[#1b1a40] text-center py-3 px-4 uppercase font-semibold text-sm",children:"Goal"}),(0,s.jsx)("th",{className:"text-[#1b1a40] text-center py-3 px-4 uppercase font-semibold text-sm",children:"Main Tasks"}),(0,s.jsx)("th",{className:"text-[#1b1a40] text-center py-3 px-4 uppercase font-semibold text-sm",children:"Parent Department"}),x&&(0,s.jsx)("th",{className:"text-[#1b1a40] text-center py-3 px-4 uppercase font-semibold text-sm",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:m.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-100 transition-colors",children:[(0,s.jsx)("td",{className:"py-3 px-4 text-center",children:e.name}),(0,s.jsx)("td",{className:"py-3 px-4 text-center",children:e.goal}),(0,s.jsx)("td",{className:"py-3 px-4 text-center",children:e.mainTasks}),(0,s.jsx)("td",{className:"py-3 px-4 text-center",children:d(e)}),x&&(0,s.jsxs)("td",{className:"py-3 px-4 flex space-x-2 justify-center",children:[(0,s.jsx)("div",{onClick:()=>f(e),className:"cursor-pointer p-2 w-16 text-xs text-center font-bold rounded-full bg-green-100 hover:bg-green-500 hover:text-green-100 text-green-500",children:"Edit"}),(0,s.jsx)("div",{className:"cursor-pointer p-2 w-16 text-xs text-center font-bold rounded-full bg-red-100 text-red-500 hover:text-red-100 hover:bg-red-500",children:"Delete"})]})]},e.id))})]})}),(0,s.jsx)(l.Z,{open:r.open,message:r.message,severity:r.severity,onClose:()=>p(e=>({...e,open:!1}))})]}):(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:"No Departments"})},m=r(2299),u=r(9376),x=r(5248),h=r(7753),f=r(9343),g=r(7583),b=r.n(g),y=e=>{let{isOpen:t,onClose:r,departmentData:n}=e,{register:o,handleSubmit:c,formState:{errors:d},reset:p}=(0,f.cI)({resolver:(0,h.X)(x.$),defaultValues:n||{}});i.useEffect(()=>{n?p(n):p()},[n,p]);let[m,g]=(0,i.useState)({open:!1,message:"",severity:"success"}),y=n?"/department/updateDepartment/".concat(n.id):"/department/create-department",{mutate:v,isPending:j,isSuccess:N,isError:w,error:D}=(0,u.s)({endpoint:y,onSuccessMessage:"Departments added successfully!",invalidateQueryKeys:["departments"]}),Z=async e=>{v({name:e.name,description:e.description,...e.parentDepartmentId&&{parent_department_id:e.parentDepartmentId}}),setInterval(r,3e3)};(0,i.useEffect)(()=>{N?(g({open:!0,message:n?"Department updated successfully!":"Department created successfully!",severity:"success"}),p({id:"",parentDepartmentId:"",description:"",name:""})):w&&console.error("Failed to create/update the department",D)},[n,D,w,N,p]);let{data:_}=(0,a.Z)({queryKey:["departments"],url:"http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com","/department/get-departments"),setSnackbarConfig:g});return(0,s.jsxs)(b(),{isOpen:t,onRequestClose:r,ariaHideApp:!1,contentLabel:"Create/Update Department",className:"fixed inset-0 flex items-center justify-center",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",children:[(0,s.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg max-w-md w-full relative",children:[(0,s.jsx)("button",{onClick:r,className:"absolute top-2 right-2  hover:text-accent",children:"\xd7"}),(0,s.jsx)("h1",{className:"text-center text-2xl  font-bold mb-6",children:n?"Update Department":"Create Department"}),(0,s.jsxs)("form",{className:"space-y-4",onSubmit:c(Z),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block  text-sm font-medium",children:"Department Name"}),(0,s.jsx)("input",{type:"text",...o("name"),className:"w-full px-4 py-2 mt-1 rounded-lg   placeholder-textSecondary focus:outline-none focus:ring-2 focus:ring-accent border ".concat(d.name?"border-high":"border-border"),placeholder:"Enter department name"}),d.name&&(0,s.jsx)("p",{className:"text-high mt-1 text-sm",children:d.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block  text-sm font-medium",children:"Description"}),(0,s.jsx)("textarea",{...o("description"),className:"w-full px-4 py-2 mt-1 rounded-lg   placeholder-textSecondary focus:outline-none focus:ring-2 focus:ring-accent border ".concat(d.description?"border-high":"border-border"),placeholder:"Enter department description",rows:4}),d.description&&(0,s.jsx)("p",{className:"text-high mt-1 text-sm",children:d.description.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block  text-sm font-medium",children:"Parent Department (Optional)"}),(0,s.jsxs)("select",{...o("parentDepartmentId"),className:"w-full px-4 py-2 mt-1 rounded-lg   placeholder-textSecondary focus:outline-none focus:ring-2 focus:ring-accent border ".concat(d.parentDepartmentId?"border-high":"border-border"),children:[(0,s.jsx)("option",{value:"",children:"Select a parent department"}),_&&_.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),d.parentDepartmentId&&(0,s.jsx)("p",{className:"text-high mt-1 text-sm",children:d.parentDepartmentId.message})]}),(0,s.jsx)("button",{type:"submit",className:"w-full py-2 mt-4 bg-[#413d99] text-white rounded-lg font-bold hover:bg-opacity-90 transition duration-200 ".concat(j?"opacity-50 cursor-not-allowed":""),disabled:j,children:j?n?"Updating...":"Creating...":n?"Update Department":"Create Department"}),w&&(0,s.jsx)("p",{className:"text-high mt-2 text-center",children:D+""}),N&&(0,s.jsx)("p",{className:"text-low mt-2 text-center",children:"Successful"})]})]}),(0,s.jsx)(l.Z,{open:m.open,message:m.message,severity:m.severity,onClose:()=>g(e=>({...e,open:!1}))})]})},v=()=>{let[e,t]=(0,i.useState)(!1),[r,a]=(0,i.useState)(null),[o,l]=(0,i.useState)("get-departments"),d=(0,c.useRouter)(),u=(0,n.D)("admin");return(0,s.jsxs)(m.Z,{children:[(0,s.jsxs)("div",{className:"col-span-full flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center",children:"Departments"}),(0,s.jsxs)("div",{className:"flex items-center gap-5",children:[(0,s.jsxs)("select",{className:"bg-white border border-gray-300 rounded-lg px-4 py-2 focus:outline-none transition duration-200",value:o,onChange:e=>l(e.target.value),children:[u&&(0,s.jsx)("option",{value:"get-departments",children:"All Departments"}),(0,n.T)(["department_view_specific"])&&(0,s.jsx)("option",{value:"view",children:"Accessible Departments"})]}),u&&(0,s.jsx)("button",{className:"bg-[#1b1a40] text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition duration-200",onClick:()=>{a(null),d.push("/departments/add-department")},children:"Add Department"})]})]}),(0,s.jsx)(p,{selectedOption:o}),(0,s.jsx)(y,{isOpen:e,onClose:()=>t(!1),departmentData:r})]})}},9671:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(9175),n=r(5740);t.Z=e=>{let{open:t,message:r,severity:o,onClose:c}=e,i=(e,t)=>{"clickaway"!==t&&c()};return(0,s.jsx)(a.Z,{open:t,autoHideDuration:2e3,onClose:i,children:(0,s.jsx)(n.Z,{onClose:i,severity:o,variant:"filled",sx:{width:"100%"},children:r})})}},2299:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{children:t,extraStyle:r}=e;return(0,s.jsx)("div",{className:"sm:w-full mobile-grid sm:desktop-grid  "+r,children:t})}},9376:function(e,t,r){"use strict";r.d(t,{s:function(){return c}});var s=r(3191),a=r(5524),n=r(8472),o=r(2649);let c=e=>{let{endpoint:t,onSuccessMessage:r,invalidateQueryKeys:c=[],options:i}=e,l=(0,s.NL)(),d=async e=>(await n.Z.post("http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com").concat(t),e,{headers:{Authorization:"Bearer ".concat(o.Z.get("access_token"))}})).data;return(0,a.D)({mutationFn:d,onSuccess:e=>{r&&console.log(r,e),c.forEach(e=>{l.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...i})}},7300:function(e,t,r){"use strict";var s=r(932),a=r(8472),n=r(2649);t.Z=e=>{let{queryKey:t,url:r,setSnackbarConfig:o,nestedData:c=!1,...i}=e;return(0,s.a)({queryKey:t,queryFn:async()=>{try{let e=await a.Z.get(r,{headers:{Authorization:"Bearer ".concat(n.Z.get("access_token"))}});return c?e.data.data:e.data}catch(e){throw a.Z.isAxiosError(e)&&e.response?o({open:!0,message:"Error: ".concat(e.response.data.message||"An error occurred"),severity:"error"}):o({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...i})}},5248:function(e,t,r){"use strict";r.d(t,{$:function(){return n},a:function(){return a}});var s=r(4245);let a=s.Ry().shape({name:s.Z_().required("Department name is required"),description:s.Z_().optional(),goal:s.Z_().required("Goal is required"),category:s.Z_().required("Category is required"),mainTasks:s.Z_().required("Main tasks are required"),parentDepartmentId:s.Z_().nullable().default(void 0),numericOwners:s.IX().of(s.Ry().shape({category:s.Z_(),count:s.Rx()})),supportingFiles:s.IX().of(s.nK()).notRequired(),requiredReports:s.IX().of(s.Ry().shape({name:s.Z_(),templateFile:s.Z_()})),developmentPrograms:s.IX().of(s.Ry().shape({programName:s.Z_(),objective:s.Z_(),notes:s.Z_(),programFile:s.Z_()}))}),n=s.Ry().shape({name:s.Z_().required("Department name is required"),description:s.Z_().required("Description is required"),parentDepartmentId:s.Z_().transform(e=>""===e?void 0:e).nullable().default(void 0)})},6716:function(e,t,r){"use strict";r.d(t,{D:function(){return n},T:function(){return a}});var s=r(1444);function a(e){let t=(0,s.v9)(e=>{var t;return(null===(t=e.user.userInfo)||void 0===t?void 0:t.job.permissions)||[]});return e.some(e=>t.includes(e))}function n(e){return e==(0,s.v9)(e=>e.user.role)}}},function(e){e.O(0,[7034,5907,4186,1336,2280,932,7583,2427,5498,2971,7023,1744],function(){return e(e.s=760)}),_N_E=e.O()}]);