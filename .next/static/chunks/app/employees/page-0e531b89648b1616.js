(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2847],{2743:function(e,t,r){Promise.resolve().then(r.bind(r,3480))},3480:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return _}});var s=r(7437),a=r(7300),n=r(6716),i=r(468),d=r(8472),l=r(2649),o=r(6463),c=r(2265),m=r(9671),u=e=>{let{selectedOption:t}=e,r=(0,n.D)("admin"),[u,p]=(0,c.useState)({open:!1,message:"",severity:"success"}),{data:x,isLoading:h,refetch:y}=(0,a.Z)({queryKey:["employees",t],url:"http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com","/emp/").concat(t),setSnackbarConfig:p}),b=(0,o.useRouter)(),f=e=>{sessionStorage.setItem("employeeData",JSON.stringify(e)),b.push("/employees/add-employee")},g=async e=>{try{await d.Z.delete("https://".concat("ec2-35-173-139-149.compute-1.amazonaws.com","/emp/delete/").concat(e),{headers:{Authorization:"Bearer "+l.Z.get("access_token")}}),y()}catch(e){console.error("Error deleting employee:",e)}};return h?(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:(0,s.jsx)(i.default,{size:100})}):x&&0!=x.length?(0,s.jsxs)("div",{className:"bg-[#f0f4f9] rounded-xl shadow-md p-4 flex flex-col space-y-4 col-span-12 ",children:[x&&x.length>0?(0,s.jsx)("div",{className:"overflow-x-auto rounded-lg shadow-md",children:(0,s.jsxs)("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[(0,s.jsx)("thead",{className:"bg-gray-200",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Name"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"DOB"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Phone"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Email"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Address"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Department"}),(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Job"}),r&&(0,s.jsx)("th",{className:"text-[#1b1a40]  text-center py-3 px-4 uppercase font-semibold text-sm",children:"Actions"})]})}),(0,s.jsx)("tbody",{children:x.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-100 transition-colors",children:[(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.name}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:new Date(e.dob).toLocaleDateString()}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.phone}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.email}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.address}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.job.department}),(0,s.jsx)("td",{className:"text-center  py-3 px-4",children:e.job.title}),r&&(0,s.jsxs)("td",{className:"text-center  py-3 px-4 flex space-x-2",children:[(0,s.jsx)("div",{onClick:()=>f(e),className:"cursor-pointer  p-2 w-16 text-xs text-center font-bold rounded-full bg-green-100 hover:bg-green-500 hover:text-green-100 text-green-500",children:"edit"}),(0,s.jsx)("div",{className:"cursor-pointer  p-2 w-16 text-xs text-center font-bold rounded-full bg-red-100 text-red-500 hover:text-red-100 hover:bg-red-500",onClick:()=>g(e.id),children:"delete"})]})]},e.id))})]})}):(0,s.jsx)("p",{className:"text-center text-gray-600 mt-4",children:"No employees found."}),(0,s.jsx)(m.Z,{open:u.open,message:u.message,severity:u.severity,onClose:()=>p(e=>({...e,open:!1}))})]}):(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-1/2 flex flex-col items-center justify-center gap-5",children:"No Employees"})},p=r(2299),x=r(9376),h=r(8379),y=r(7753),b=r(9343),f=r(7583),g=r.n(f);let j="ec2-35-173-139-149.compute-1.amazonaws.com";var v=e=>{let{isOpen:t,onClose:r,employeeData:n}=e,{register:i,handleSubmit:d,formState:{errors:l},reset:o}=(0,b.cI)({resolver:(0,y.X)(h.Z),defaultValues:n||{}}),[u,p]=(0,c.useState)(null);(0,c.useEffect)(()=>{n?o(n):o()},[n,o]);let[f,v]=(0,c.useState)({open:!1,message:"",severity:"success"}),_=n?"/emp/update/".concat(n.id):"/emp/create",{mutate:q,isPending:N,isSuccess:w,isError:Z,error:E}=(0,x.s)({endpoint:_,onSuccessMessage:"Employee added successfully!",invalidateQueryKeys:["employees"]});(0,c.useEffect)(()=>{w?(v({open:!0,message:n?"Employee updated successfully!":"Employee created successfully!",severity:"success"}),o()):Z&&(console.error("Error creating/updating employee:",E),p(E+""||"Failed to process the request. Please try again."))},[n,E,Z,w,o]);let D=async e=>{p(null),q({name:e.name,dob:e.dob,phone:e.phone,email:e.email,address:e.address,department_id:e.department_id,job_id:e.job_id,password:!n&&e.password}),setInterval(r,3e3)},{data:k}=(0,a.Z)({queryKey:["departments"],url:"http://".concat(j,"/department/get-departments"),setSnackbarConfig:v}),{data:A}=(0,a.Z)({queryKey:["jobTitles"],url:"http://".concat(j,"/job-titles/get-job-titles"),setSnackbarConfig:v});return(0,s.jsxs)(g(),{isOpen:t,onRequestClose:r,ariaHideApp:!1,contentLabel:"Create/Update Employee",className:"fixed inset-0 flex items-center justify-center",overlayClassName:"fixed inset-0 bg-black bg-opacity-50 z-50",children:[(0,s.jsxs)("div",{className:"bg-white p-8 rounded-xl shadow-lg max-w-md w-full relative",children:[(0,s.jsx)("button",{onClick:r,className:"absolute top-2 right-2 text-gray-700 hover:text-red-500",children:"\xd7"}),(0,s.jsx)("h1",{className:"text-center text-2xl font-bold mb-6",children:n?"Update Employee":"Create Employee"}),(0,s.jsxs)("form",{className:"space-y-4",onSubmit:d(D),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Name"}),(0,s.jsx)("input",{type:"text",...i("name"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.name?"border-red-500":"border-gray-300"),placeholder:"Enter employee name"}),l.name&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.name.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Date of Birth"}),(0,s.jsx)("input",{type:"date",...i("dob"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.dob?"border-red-500":"border-gray-300"),placeholder:"Enter date of birth"}),l.dob&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.dob.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Phone"}),(0,s.jsx)("input",{type:"text",...i("phone"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.phone?"border-red-500":"border-gray-300"),placeholder:"Enter phone number"}),l.phone&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.phone.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Email"}),(0,s.jsx)("input",{type:"email",...i("email"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.email?"border-red-500":"border-gray-300"),placeholder:"Enter email"}),l.email&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.email.message})]}),!n&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Password"}),(0,s.jsx)("input",{type:"text",...i("password"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.email?"border-red-500":"border-gray-300"),placeholder:"Enter Password"}),l.password&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.password.message})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"Address"}),(0,s.jsx)("input",{type:"text",...i("address"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.address?"border-red-500":"border-gray-300"),placeholder:"Enter address"}),l.address&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.address.message})]}),(0,s.jsxs)("select",{...i("department_id"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.department_id?"border-red-500":"border-gray-300"),children:[(0,s.jsx)("option",{value:"",children:"Select a department"}),k&&k.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),l.department_id&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.department_id.message}),(0,s.jsxs)("select",{...i("job_id"),className:"w-full px-4 py-2 mt-1 rounded-lg border ".concat(l.department_id?"border-red-500":"border-gray-300"),children:[(0,s.jsx)("option",{value:"",children:"Select a job title"}),A&&A.map(e=>(0,s.jsx)("option",{value:e.id,children:e.title},e.id))]}),l.job_id&&(0,s.jsx)("p",{className:"text-red-500 mt-1 text-sm",children:l.job_id.message}),(0,s.jsx)("button",{type:"submit",className:"w-full py-2 mt-4 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition duration-200 ".concat(N?"opacity-50 cursor-not-allowed":""),disabled:N,children:N?n?"Updating...":"Creating...":n?"Update Employee":"Create Employee"}),u&&(0,s.jsx)("p",{className:"mt-2 text-center ".concat(u.includes("successfully")?"text-green-500":"text-red-500"),children:u})]})]}),(0,s.jsx)(m.Z,{open:f.open,message:f.message,severity:f.severity,onClose:()=>v(e=>({...e,open:!1}))})]})},_=()=>{let[e,t]=(0,c.useState)(!1),[r,a]=(0,c.useState)(null),[i,d]=(0,c.useState)("get-all-emps"),l=(0,o.useRouter)(),m=(0,n.D)("admin");return(0,c.useEffect)(()=>{console.log(i)},[i]),(0,s.jsxs)(p.Z,{children:[(0,s.jsxs)("div",{className:"col-span-full flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center ",children:"Employees Management"}),(0,s.jsxs)("div",{className:"flex justify-center items-center gap-5",children:[(0,s.jsxs)("select",{className:"bg-white border border-gray-300 rounded-lg px-4 py-2 focus:outline-none transition duration-200",value:i,onChange:e=>d(e.target.value),children:[m&&(0,s.jsx)("option",{value:"get-all-emps",children:"All Employees"}),(0,n.T)(["emp_view_specific"])&&(0,s.jsx)("option",{value:"view",children:"View Accessible Employees"}),(0,n.D)("primary_user")&&(0,s.jsx)("option",{value:"get-my-emps",children:"My Department Employees"})]}),m&&(0,s.jsx)("button",{className:"bg-[#1b1a40] text-white px-6 py-2 rounded-lg hover:bg-opacity-90 transition duration-200",onClick:()=>{a(null),l.push("/employees/add-employee")},children:"Add Employee"})]})]}),(0,s.jsx)(u,{selectedOption:i}),(0,s.jsx)(v,{isOpen:e,onClose:()=>t(!1),employeeData:r})]})}},9671:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(9175),n=r(5740);t.Z=e=>{let{open:t,message:r,severity:i,onClose:d}=e,l=(e,t)=>{"clickaway"!==t&&d()};return(0,s.jsx)(a.Z,{open:t,autoHideDuration:2e3,onClose:l,children:(0,s.jsx)(n.Z,{onClose:l,severity:i,variant:"filled",sx:{width:"100%"},children:r})})}},2299:function(e,t,r){"use strict";var s=r(7437);r(2265),t.Z=e=>{let{children:t,extraStyle:r}=e;return(0,s.jsx)("div",{className:"sm:w-full mobile-grid sm:desktop-grid  "+r,children:t})}},9376:function(e,t,r){"use strict";r.d(t,{s:function(){return d}});var s=r(3191),a=r(5524),n=r(8472),i=r(2649);let d=e=>{let{endpoint:t,onSuccessMessage:r,invalidateQueryKeys:d=[],options:l}=e,o=(0,s.NL)(),c=async e=>(await n.Z.post("http://".concat("ec2-35-173-139-149.compute-1.amazonaws.com").concat(t),e,{headers:{Authorization:"Bearer ".concat(i.Z.get("access_token"))}})).data;return(0,a.D)({mutationFn:c,onSuccess:e=>{r&&console.log(r,e),d.forEach(e=>{o.invalidateQueries(e)})},onError:e=>{console.error("Error during the create/add request:",e)},...l})}},7300:function(e,t,r){"use strict";var s=r(932),a=r(8472),n=r(2649);t.Z=e=>{let{queryKey:t,url:r,setSnackbarConfig:i,nestedData:d=!1,...l}=e;return(0,s.a)({queryKey:t,queryFn:async()=>{try{let e=await a.Z.get(r,{headers:{Authorization:"Bearer ".concat(n.Z.get("access_token"))}});return d?e.data.data:e.data}catch(e){throw a.Z.isAxiosError(e)&&e.response?i({open:!0,message:"Error: ".concat(e.response.data.message||"An error occurred"),severity:"error"}):i({open:!0,message:"Network error. Please try again later.",severity:"error"}),e}},retry:2,...l})}},8379:function(e,t,r){"use strict";r.d(t,{Z:function(){return n},d:function(){return a}});var s=r(4245);let a=s.Ry().shape({id:s.Z_().optional(),name:s.Z_().required("Employee name is required"),national_id:s.Z_().required("National Id is required"),gender:s.Z_().required("Gender is required"),marital_status:s.Z_().required("Marital status is required"),address:s.Z_().required("Address is required"),employment_date:s.Z_().required("Employment date is required").matches(/^\d{4}-\d{2}-\d{2}$/,"Employment date must be in YYYY-MM-DD format"),base_salary:s.Rx().required("Base salary is required"),dob:s.Z_().required("Date of birth is required").matches(/^\d{4}-\d{2}-\d{2}$/,"Date of birth must be in YYYY-MM-DD format"),phone:s.Z_().required("Phone number is required"),email:s.Z_().required("Email is required").email("Invalid email format"),password:s.Z_().required("password is required"),department_id:s.Z_().required("Department ID is required"),job_id:s.Z_().required("Job ID is required"),job_tasks:s.Z_().required("Job tasks is required"),emergency_contact:s.Z_().required("emergency contact is required"),legal_documents:s.IX().of(s.Ry().shape({name:s.Z_().required("Document name is required"),validity:s.Z_().nullable(),file:s.Z_().nullable()})).optional(),certifications:s.IX().of(s.Ry().shape({certificate_name:s.Z_().required("Certificate name is required"),date:s.Z_().nullable(),grade:s.Z_().required("Grade is required"),file:s.Z_().nullable()})).optional(),allowances:s.IX().of(s.Ry().shape({allowance_type:s.Z_().required("Allowance type is required"),amount:s.Rx().required("Allowance amount is required").positive("Amount must be a positive number")})).optional(),incentives:s.IX().of(s.Ry().shape({description:s.Z_().required("Incentive description is required"),amount:s.Rx().required("Incentive amount is required").positive("Amount must be a positive number")})).optional(),bank_accounts:s.IX().of(s.Ry().shape({bank_name:s.Z_().required("Bank name is required"),account_number:s.Z_().required("Account number is required").matches(/^\d+$/,"Account number must contain only digits")})).optional(),evaluations:s.IX().of(s.Ry().shape({evaluation_type:s.Z_().required("Evaluation type is required"),description:s.Z_().required("Evaluation description is required"),plan:s.Z_().required("Plan is required")})).optional()}),n=s.Ry().shape({name:s.Z_().required("Employee name is required"),dob:s.hT().required("Date of birth is required").typeError("Invalid date format"),phone:s.Z_().required("Phone number is required"),password:s.Z_(),email:s.Z_().required("Email is required").email("Invalid email format"),address:s.Z_().required("Address is required"),department_id:s.Z_().required("Department ID is required"),job_id:s.Z_().required("Job ID is required")})},6716:function(e,t,r){"use strict";r.d(t,{D:function(){return n},T:function(){return a}});var s=r(1444);function a(e){let t=(0,s.v9)(e=>{var t;return(null===(t=e.user.userInfo)||void 0===t?void 0:t.job.permissions)||[]});return e.some(e=>t.includes(e))}function n(e){return e==(0,s.v9)(e=>e.user.role)}}},function(e){e.O(0,[7034,5907,4186,1336,2280,932,7583,2427,37,2971,7023,1744],function(){return e(e.s=2743)}),_N_E=e.O()}]);